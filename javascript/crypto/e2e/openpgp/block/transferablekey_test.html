<!-- Copyright 2013 Google Inc. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// -->
<!DOCTYPE html>
<title>Unit Test of e2e.block.TransferableKey</title>
<script src="../../../../closure/base.js"></script>
<script src="test_js_deps-runfiles.js"></script>
<script>
  goog.require('goog.array');
  goog.require('goog.testing.jsunit');
  goog.require('e2e.openpgp.block.all');
  goog.require('e2e.openpgp.block.factory');
 </script>

<!--
Public key block containing a signing subkey (with binding 0x19 signature)
:public key packet:
  version 4, algo 1, created 1408612889, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:user ID packet: "signing-subkey <signing-subkey@example.com>"
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612889, md5len 0, sigclass 0x13
  digest algo 2, begin of digest e9 eb
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1408612889, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612889, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b1 7c
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1408612974, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408612974, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 93 5a
  hashed subpkt 2 len 4 (sig created 2014-08-21)
  hashed subpkt 27 len 1 (key flags: 02)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  subpkt 32 len 156 (signature: v4, class 0x19, algo 1, digest algo 2)
  data: [1021 bits]
-->
<textarea id="SigningSubkey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mI0EU/W6GQEEALr7DpMdrxW2/X1GTepEeABgojRLY7TdGBGR6r7VWzmKh2agQdAC
FyvBcRb/tGwwZmimxyxsws7o+2h3oaM8GL0OQ9WEi1035G5DQweHM989Yw84Dj1O
WeXZxRKAqU93+rEz6xys9BYteqL6SNyNt29EjZ7W+mRtWCRUxViaJhGhABEBAAG0
K3NpZ25pbmctc3Via2V5IDxzaWduaW5nLXN1YmtleUBleGFtcGxlLmNvbT6ItwQT
AQIAIQUCU/W6GQIbAwYLCQgHAwIGFQgCCQoLAxYCAQIeAQIXgAAKCRBqaacQD4xc
R+nrBACSTSve7hlxRONletyvDIeQWewQi6ePXkPGWElPrvf8BjEynDMsJHJiDblO
rv0uvpELS2v+OvzJLGD97arenkfWq7PTp7Lm/CWdrJmvCFTZc2gUyTtxMExre2co
uTpfsUNwZudQwe/n9X9oQ0gAXyT79puJ44SqJ5rB2iQj97YOtbiNBFP1uhkBBACi
80AIcHy8YG2UrfCEy+pThYBJxevsS34ne4jwPQFvQe6XULojujaZ8mUmQ3QeNLhS
oBS6q3zhE/FCSpbjt6IWTmYqXz4gH1AGxCv3kEfUc4s1iVj2/u9lNP7Sh7nzNlFp
mfy59uxn4bS1qXf0K6bVIJMj2T3Aq73bOyk/DWvUqwARAQABiJ8EGAECAAkFAlP1
uhkCGwwACgkQammnEA+MXEexfAQAo7wANLUBF9SMKsoGtMZGgIHXpc27E25Nr2IN
/du5mM7MvJXz7wSU8upw89q2g2LvmpoxMshWfw1hRLR92KIzNEb6HFt/WfIxLBeO
RKLu+kETTWN4cnbU8Rtg8Rvw7OY92/vnvwjv1HXXF2qAbf+Lj0Jy7e6h7C+dAXfS
ZdLlE924jQRT9bpuAQQApdRMs7l2uCQtQOg2qRyoUbQdkaCj+6ON5hvN7swUkLaN
zOT6E0V+mQUjHDbnbS8U3sFEyOwciNvzt1KRKUhsZFN4xaPSYXECw1JQMcZczZ2w
9OOcJrVLpJFrv5cQFrx5X9jfTWePXuC40rXzPZ/RvggSMSlW+dWeFPFA2OYszOkA
EQEAAYkBPQQYAQIACQUCU/W6bgIbAgCoCRBqaacQD4xcR50gBBkBAgAGBQJT9bpu
AAoJEPTeZfMn+FaMeIQD/iNfsKYvRPWHEDcSHL8Cp5Gsf8fshrl4yA7md0SFq627
BtW+wYSBoUE1yuMQhQ64mzMOawvw9kZlYYZuMNmzaY9wtlSe8JpNm0OW10vp7bv3
FNaxBfJa2d+G8wkMPthAbSISd25P6LN1E3szD1IXpnTpY3GMfy1Ed8PFDD5IX26n
k1oD/RBBJp4qH81YpH4PrbBDtliH4xvSHZB/VxAf0AyUmCPj6Mk7SeOFpPayvpMs
ygwBuLvy1JANBI3DLckdmI1tSeOScBpjWqmtWB92U7G3s6bOtyDioDsjBrKzrx8G
RYE/ktdjGkfHqR4TSu7/51yofDGLY1ZHXUp9Kk3PbKWH4Uw5
=8AAO
-----END PGP PUBLIC KEY BLOCK-----
</textarea>

<!--
Revoked subkey:
:public key packet:
  version 4, algo 1, created 1402245840, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:user ID packet: "revoked <revoked@revoked.net>"
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245840, md5len 0, sigclass 0x13
  digest algo 2, begin of digest c0 34
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2047 bits]
:public sub key packet:
  version 4, algo 1, created 1402245840, expires 0
  pkey[0]: [2048 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245876, md5len 0, sigclass 0x28
  digest algo 2, begin of digest b6 9d
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 29 len 14 (revocation reason 0x02 (revoke subkey))
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2047 bits]
:signature packet: algo 1, keyid 1875FF0B267CDC0E
  version 4, created 1402245840, md5len 0, sigclass 0x18
  digest algo 2, begin of digest 1d 4e
  hashed subpkt 2 len 4 (sig created 2014-06-08)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 1875FF0B267CDC0E)
  data: [2048 bits]
-->
<textarea id="RevokedSubKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1

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
=80Vy
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Revoked main key:
// Key generation instruction:
// gpg --gen-key (RSA/RSA/1024 - uid=revoked-main)
// gpg --edit revoked-main
// gpg> revkey, key has been compromised, save, quit
:public key packet:
  version 4, algo 1, created 1408442396, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442501, md5len 0, sigclass 0x20
  digest algo 2, begin of digest 19 4c
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 29 len 25 (revocation reason 0x02 (Main key revocation test))
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1024 bits]
:user ID packet: "revoked-main <revoked-main@example.com>"
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442396, md5len 0, sigclass 0x13
  digest algo 2, begin of digest c2 1a
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1022 bits]
:public sub key packet:
  version 4, algo 1, created 1408442396, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid 44416104FBFEA899
  version 4, created 1408442396, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b4 39
  hashed subpkt 2 len 4 (sig created 2014-08-19)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID 44416104FBFEA899)
  data: [1022 bits]
-->
<textarea id="RevokedMainKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mI0EU/MgHAEEALgGq+UDj7R5XwEl3wDzx4M2K3oBJI6ISuc7nJTCbNrcZ2yahAdF
i9Qmunoa8/rryHQZovuBX4QjkZsxorVzFmH+qvaczUYYMsN6vXGKAsPn0OX6AjRs
VesFtqZyi3yW9pLZaCRuikWeUumgJdbFBFS6uoGGwDKK0X1sqajFGIrlABEBAAGI
twQgAQIAIQUCU/MghRodAk1haW4ga2V5IHJldm9jYXRpb24gdGVzdAAKCRBEQWEE
+/6omRlMBACHerNXj6TFIf/h9yjVnL2PmvoMuAVMftVOnXJQq3ikW44Hu9iY+YwX
M6cevKXETAGuEhvKmBAneNUoC0oaQvel5G7VHQTJqlhVRzpv1M/Rqj3879VbGsSh
gmthv8y2lcPRcXvsB0FY/Jxi4v26CcvreYa77efvywuLD+fTaVOY6bQncmV2b2tl
ZC1tYWluIDxyZXZva2VkLW1haW5AZXhhbXBsZS5jb20+iLcEEwECACEFAlPzIBwC
GwMGCwkIBwMCBhUIAgkKCwMWAgECHgECF4AACgkQREFhBPv+qJnCGgP+LvSRVdS4
K+8Ps/LVplD8DP5jDOnMQIHanr85g8RD76gCXD7vqTCaQZbrwRwR43C1g+CB47vJ
l7jToVhjhdGKHKiRxoyF/xwhTDM9LtWA1PwneecoMYTTR4f8dvd+gX/BAOfwahlP
R/CoC8sUflBWb3nezl7mRXpKhVnLxo5DJKC4jQRT8yAcAQQA6xCjxRKKSPxp2lMl
Bd3a+qPtrW32THL7H0dpq+FJ0UiuP78Z6nQ1DWdMFIgQx4SBoBpnTlYNjiG4+XIk
e1WOVvLMpgBTjPHk/BCrweZhHbV/BF97sLxHcqDU40Uf/UUFweEUbVHAD5XrQasz
JmP9EAUUSEDUh/hh5tnPf/avw1sAEQEAAYifBBgBAgAJBQJT8yAcAhsMAAoJEERB
YQT7/qiZtDkD/jCMvfGLZDbw4pjPT/iHTynmltD57X946rqAkOp0mKdyxKS6CbIZ
nR2/cVSIeQoSBWU+qTj52Uw5bWj3uOVvJNfcAPOt7oyYdUJR0WojD7HXYJH9ym0G
/fgSVhEjpq3TDFQQ/s41bw6Nqbnqn+UAdOi97x9ow+zHd2OtVbnCICRE
=VB3i
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
ECC key to check subkey/user id signature verification.
:public key packet:
  version 4, algo 19, created 1377714336, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: EAEB8A76AFE8C867
:user ID packet: "ecc real name <ecc@example.com>"
:signature packet: algo 19, keyid EAEB8A76AFE8C867
  version 4, created 1377714336, md5len 0, sigclass 0x13
  digest algo 8, begin of digest c6 d7
  hashed subpkt 2 len 4 (sig created 2013-08-28)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID EAEB8A76AFE8C867)
  data: [254 bits]
  data: [254 bits]
:public sub key packet:
  version 4, algo 18, created 1377714336, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: DBA95B52C1FBBA97
:signature packet: algo 19, keyid EAEB8A76AFE8C867
  version 4, created 1377714336, md5len 0, sigclass 0x18
  digest algo 8, begin of digest 3a 90
  hashed subpkt 2 len 4 (sig created 2013-08-28)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID EAEB8A76AFE8C867)
  data: [256 bits]
  data: [253 bits]
-->
<textarea id="EccKey">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.1.0-ecc (GNU/Linux)

mFIEUh5AoBMIKoZIzj0DAQcCAwT68182duSEJFXKa+qkBa0Vgeswnv8GP8tKYiU/
MCZd6dGTvrtf2gSjyAsVkB0V0idW7i8yW1wfh3y2AbGWDr/dtB9lY2MgcmVhbCBu
YW1lIDxlY2NAZXhhbXBsZS5jb20+iHoEExMIACIFAlIeQKACGwMGCwkIBwMCBhUI
AgkKCwQWAgMBAh4BAheAAAoJEOrrinav6MhnxtcA/iAteDFo/P5SU5XV/8/4BN9x
f28SuvwFipnjjyOmvB0eAP4kPM5LAp2EW+QIyG6+CJP1No9uWyZTdLPkTRgLtYhi
GLhWBFIeQKASCCqGSM49AwEHAgMEgk1dVpgPCM38NBNoBcvehm7mt6aUmK8mDb/M
SHo2/NlwfTh+BDCoVX5asSetzuW2RbnP6sCBwfsuLSrSWUVauwMBCAeIYQQYEwgA
CQUCUh5AoAIbDAAKCRDq64p2r+jIZzqQAQCcv0VOQFiNOM6JNdLHTqlCYxeoz09d
UP3LdgcnLED/YwD9FqcNrkok9BuXJ9+rXTSu+uqdWB7gpMO9mfk65d5IQ+s=
=xRCj
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Revoked one of two user IDs. Both user IDs are additionally signed by a
foreign key.

:public key packet:
  version 4, algo 19, created 1408970397, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: E3CE624C647B3A23
:user ID packet: "revoked-userid <revoked-userid@example.com>"
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970568, md5len 0, sigclass 0x30
  digest algo 8, begin of digest 1c f0
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 29 len 27 (revocation reason 0x20 (Revocation because why not))
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [255 bits]
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970397, md5len 0, sigclass 0x13
  digest algo 8, begin of digest 77 ed
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [255 bits]
  data: [256 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408970499, md5len 0, sigclass 0x10
  digest algo 2, begin of digest 83 58
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1023 bits]
:user ID packet: "non-revoked-uid <non-revoked-uid@example.com>"
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970478, md5len 0, sigclass 0x13
  digest algo 8, begin of digest b9 c1
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [256 bits]
:signature packet: algo 1, keyid 6A69A7100F8C5C47
  version 4, created 1408970530, md5len 0, sigclass 0x10
  digest algo 2, begin of digest c8 26
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  subpkt 16 len 8 (issuer key ID 6A69A7100F8C5C47)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 18, created 1408970397, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: 4A5DD549DCAB5055
:signature packet: algo 19, keyid E3CE624C647B3A23
  version 4, created 1408970397, md5len 0, sigclass 0x18
  digest algo 8, begin of digest c3 f7
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID E3CE624C647B3A23)
  data: [256 bits]
  data: [256 bits]
-->
<textarea id="RevokedUserId">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

mFIEU/sunRMIKoZIzj0DAQcCAwSRgY4eg7fVp2ILsmsFI4oZ2eXsqgemV7kNGuWa
tA+gmCXTxoLc2IK6PVM+93u4AJObM7Cm/6vJHW95Ohs8cqXWtCtyZXZva2VkLXVz
ZXJpZCA8cmV2b2tlZC11c2VyaWRAZXhhbXBsZS5jb20+iHsEMBMIACMFAlP7L0gc
HSBSZXZvY2F0aW9uIGJlY2F1c2Ugd2h5IG5vdAAKCRDjzmJMZHs6IxzwAQD7v+oy
LR2Ea2cMO4bhRG5KKqg5sJfIdm5QIWBKNCYDGQD/Qnb5/uNa1I4KLxVF2bpouHWO
cbyvp3Tk2163gSYgu3eIeQQTEwgAIQUCU/sunQIbAwYLCQgHAwIGFQgCCQoLAxYC
AQIeAQIXgAAKCRDjzmJMZHs6I3ftAP9Q2bQYrXij2IoBFfWCxD0nRc2PibyTY0ea
v4yG/Yrc9wEAhlQEKK5zgm+dIyuTufuYxPerrX/KcYRfTSMxoeLG7KaInAQQAQIA
BgUCU/svAwAKCRBqaacQD4xcR4NYA/9ohUViw/7kCVV2FQaQ4L22dNC/VdHKg+eL
U/5hR/Cdn8BwVKuQV8mqxuoDHLw+rg21MGYO5npiauUrewSvN1uoPBRKHZEL1gTj
Opf2dNesGP2xt1nv3TBzIxhDoovG/BXFLYuPeyiladYr6a48BF8iTpH8ESeO5SoV
0eVqT7ywtbQtbm9uLXJldm9rZWQtdWlkIDxub24tcmV2b2tlZC11aWRAZXhhbXBs
ZS5jb20+iHkEExMIACEFAlP7Lu4CGwMGCwkIBwMCBhUIAgkKCwMWAgECHgECF4AA
CgkQ485iTGR7OiO5wQEAmS1n8oOVj6c3L8wdsOVPFSJ0BDGjgkHU5c58LPuKWjsB
AMf3ukqQrQ7kojTXU6MmiGIQhZ9VWpuVcIzo0jMI/4o3iJwEEAECAAYFAlP7LyIA
CgkQammnEA+MXEfIJgQAqjUAlIjw9+Ya658RWZCbSE6Jf8kAjn6YKQVbC633WpXC
Jx9zeqptMebx7nxQTO/6KVUUFMC4U4z5zS8jP6tJYHvd3tgGXFAqF/YSMMAHiiK4
QTNlIE2x+nGrKaOlge9kypCjri2a1gTE9EQxIzVGUVq5gh/IaA1fYL/qqrROQP+4
VgRT+y6dEggqhkjOPQMBBwIDBPXHqP0+8NdmZV/UwPlp4lGbk/sjpBllI4WNTFC/
fsIfZQL9Ud/7uQQtoENfEG/lNW8wSP9AFfsiQDNIB+V08MoDAQgHiGEEGBMIAAkF
AlP7Lp0CGwwACgkQ485iTGR7OiPD9wEAirEelh1tRYGxy1Ghu9NBxLwXhY4BWtNd
NPC1SyXUmj0BAMi7TSyZFM1ETkAJJ1fnRREC1jBFHBBCg2J8Iwt0DCA7
=8vBI
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
Key with user attribute packet
:public key packet:
  version 4, algo 19, created 1408973778, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  keyid: D66B9F52D48A1C09
:user ID packet: "user-attr <user-attr@example.com>"
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973778, md5len 0, sigclass 0x13
  digest algo 8, begin of digest a2 75
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [253 bits]
:attribute packet: [jpeg image of size 6078]
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973923, md5len 0, sigclass 0x13
  digest algo 8, begin of digest cc 0d
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 03)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 2 (pref-zip-algos: 2 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [256 bits]
:public sub key packet:
  version 4, algo 18, created 1408973778, expires 0
  pkey[0]: [72 bits] nistp256 (1.2.840.10045.3.1.7)
  pkey[1]: [515 bits]
  pkey[2]: [32 bits]
  keyid: F253FF905C7BE669
:signature packet: algo 19, keyid D66B9F52D48A1C09
  version 4, created 1408973778, md5len 0, sigclass 0x18
  digest algo 8, begin of digest 7e 50
  hashed subpkt 2 len 4 (sig created 2014-08-25)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID D66B9F52D48A1C09)
  data: [256 bits]
  data: [256 bits]
-->
<textarea id="UserAttr">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2

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
GUlOSbBIO0YLTF2/1JxqHAlyk0E+WuNVyii53Q==
=lcS+
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<!--
RSA keys. Only the 2nd subkey should be used for encryption, as noted in the
flags.

pub  1024R/5DDBA594  created: 2014-09-03  expires: never       usage: SCE
                     trust: ultimate      validity: ultimate
sub  1024R/8D9632F1  created: 2014-09-03  expires: never       usage: A
sub  1024R/B6307BCA  created: 2014-09-03  expires: never       usage: E
[ultimate] (1). different-encryption-subkey
    <different-encryption-subkey@example.com>

:public key packet:
  version 4, algo 1, created 1409749099, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:user ID packet: "different-encryption-subkey <different-encryption-subkey@example.com>"
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749099, md5len 0, sigclass 0x13
  digest algo 2, begin of digest 73 c6
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 0F)
  hashed subpkt 11 len 5 (pref-sym-algos: 9 8 7 3 2)
  hashed subpkt 21 len 5 (pref-hash-algos: 8 2 9 10 11)
  hashed subpkt 22 len 3 (pref-zip-algos: 2 3 1)
  hashed subpkt 30 len 1 (features: 01)
  hashed subpkt 23 len 1 (key server preferences: 80)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
  data: [1023 bits]
:public sub key packet:
  version 4, algo 1, created 1409749141, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749141, md5len 0, sigclass 0x18
  digest algo 2, begin of digest b1 8e
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 20)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
  data: [1024 bits]
:public sub key packet:
  version 4, algo 1, created 1409749184, expires 0
  pkey[0]: [1024 bits]
  pkey[1]: [17 bits]
:signature packet: algo 1, keyid D423EB9C5DDBA594
  version 4, created 1409749184, md5len 0, sigclass 0x18
  digest algo 2, begin of digest a0 b4
  hashed subpkt 2 len 4 (sig created 2014-09-03)
  hashed subpkt 27 len 1 (key flags: 0C)
  subpkt 16 len 8 (issuer key ID D423EB9C5DDBA594)
-->
<textarea id="GnuPgKeyUsageFlags">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.11 (GNU/Linux)

mI0EVAcQawEEAN3GlVqNbwKGrM3TjUfunatWqY5dzdBPyHMSQAt7tFbH3Mm8AZg7
egdWduEYSBD9GRt89QGDhfjLhPa2YUqemnLXVsqnEYrtthmwidzNOVvb25ItYZSZ
F0EYPk4TCPNLsbzaTC2KaWKNaZ6M0Fl/Oy5qKiUefBFlIR9py7+feelTABEBAAG0
RWRpZmZlcmVudC1lbmNyeXB0aW9uLXN1YmtleSA8ZGlmZmVyZW50LWVuY3J5cHRp
b24tc3Via2V5QGV4YW1wbGUuY29tPoi4BBMBAgAiBQJUBxBrAhsPBgsJCAcDAgYV
CAIJCgsEFgIDAQIeAQIXgAAKCRDUI+ucXdullHPGA/9SfXE8QSQoREWrJoAwI/Pg
/SmErfJDqwwAsnf+NHC2IUiiA4nm8+rV7LAgw3DZ/WfxQDOuyj2iwxFXDt+KEpmp
TRWspvBVreDoJrVsHOU/1OQNJKDdgIxapQhCLFaAOqfFIugAN6NuMFOHev+9yJC0
mt0Q02Zp+p3XMMiNYsz5tbiNBFQHEJUBBADc6N8Bsg0Glmt3Y47AyIfFh7l6b13t
tQ3E0ok3lgE/6SGcnmHf5HN2V3qxdyP/DZJmtNp56MBJdzpDPKnFovTqGKPz6bNz
HnhDxpBDl0AV3JRhVd6/GwpYT4atvC7Djhw7y3QGWPBRQSok+2VyTCLoOaohIklg
voHBG/2lNl5j9wARAQABiJ8EGAECAAkFAlQHEJUCGyAACgkQ1CPrnF3bpZSxjgQA
0dES+OPzNfC/lE8pTCNKCsghHS9F3jvOPq8LYLlYUExiZXHpKHvK7iK0SO7T+AXc
ICR0g3rZnGa4VEupA3J8T8i7SYAiipfS/0jWaq9ffvUYA5A7ZsaoRpTijU00UfAC
etpSf8nUXM0S8U1zsOtwGADtbdAZRKGljCR2EVGt5dy4jQRUBxDAAQQAr/qpkl7M
vYc0L6cKGZLk6HaPYsOpZCmkhGhLdls9wA4n9z9j7Y0M3Z9h/ZaGvBq4leNTAM3p
70uLUTZw9izfZqY3RSBDwPApfT4zWobcWfyPOg0AS5+fraahcAyZXbqyWjVkg8Bs
b5cBV+TLW3x6FlyedXwgJ8trGSwgOMHod6cAEQEAAYifBBgBAgAJBQJUBxDAAhsM
AAoJENQj65xd26WUoLQD/0WLj5Xbg3RpZ0JAKEyi5IBqJ9thZz7JOE0cJtqcjhzA
SFg0U0bwROqmKl3upwok+mrlw5SuTJOMNNGACrFoco/z5Q53t4TgvqD4rF/PPCM5
j/GbY0dnReClicttomuqZKLB3ANeap1s8cmJSinmtL+0lwNUzW/swRX3rw/Fo1Mn
=x53K
-----END PGP PUBLIC KEY BLOCK-----
</textarea>
<script>
function getKey(id) {
  return e2e.openpgp.block.factory.parseAscii(
      document.getElementById(id).value);
}


function testSigningSubkey() {
  var key = getKey('SigningSubkey');
  var mainKeyId = key.keyPacket.keyId;
  var signingSubKey = key.subKeys[1];
  var bindingSig = signingSubKey.bindingSignatures_[0];
  assertArrayEquals(mainKeyId, bindingSig.getSignerKeyId());
  assertTrue(bindingSig.embeddedSignature
      instanceof e2e.openpgp.packet.Signature);
  assertTrue(Boolean(bindingSig.attributes.KEY_FLAG_SIGN));
  var crossSignature = bindingSig.embeddedSignature;
  assertArrayEquals(signingSubKey.keyId, crossSignature.getSignerKeyId());
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.PRIMARY_KEY,
      crossSignature.signatureType);
  key.processSignatures();
  assertEquals(2, key.subKeys.length);
}

function testEmbeddedSignatures() {
  var key, error;
  // Remove embedded signature
  key = getKey('SigningSubkey');
  delete key.subKeys[1].bindingSignatures_[0].embeddedSignature;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
  // Tamper signature type
  key = getKey('SigningSubkey');
  key.subKeys[1].bindingSignatures_[0].embeddedSignature.signatureType =
      e2e.openpgp.packet.Signature.SignatureType.SUBKEY;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
  // Invalidate signature
  key = getKey('SigningSubkey');
  key.subKeys[1].bindingSignatures_[0].embeddedSignature.signature.s ^= 0x01;
  error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testSignatureVerification() {
  var keyBlock = getKey('EccKey');
  assertEquals(1, keyBlock.subKeys[0].bindingSignatures_.length);
  assertEquals(
      e2e.openpgp.packet.Signature.SignatureType.SUBKEY,
      keyBlock.subKeys[0].bindingSignatures_[0].signatureType);
  assertArrayEquals(
      keyBlock.subKeys[0].bindingSignatures_[0].untrustedAttributes.ISSUER,
      keyBlock.keyPacket.keyId);
  // Modify the signature.
  keyBlock.subKeys[0].bindingSignatures_[0].signature.s ^= 0x01;

  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      keyBlock.serialize());
  var tamperedKey = e2e.openpgp.block.factory.parseAscii(tamperedAscii);
  var error = assertThrows(function() {
    tamperedKey.processSignatures(); // Signature tampering invalidates the key.
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedSubkey() {
  // Test for https://code.google.com/p/end-to-end/issues/detail?id=60
  // GnuPG places subkey revocation signature packet right after subkey
  // packet.
  var publicKeyBlock = getKey('RevokedSubKey');

  // Parsing revocation signature
  assertEquals(1, publicKeyBlock.subKeys.length);
  var revokedSubkey = publicKeyBlock.subKeys[0];
  assertEquals(1, revokedSubkey.revocations_.length);
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.SUBKEY_REVOCATION,
      revokedSubkey.revocations_[0].signatureType);
  assertEquals(e2e.openpgp.packet.Signature.RevocationReason.KEY_COMPROMISED,
      revokedSubkey.revocations_[0].attributes.REVOCATION_REASON);
  assertEquals('revoke subkey',
      revokedSubkey.revocations_[0].attributes.REVOCATION_REASON_TEXT);
  assertEquals(1, revokedSubkey.bindingSignatures_.length);
  // Applying revocation signature removes the revoked subkey, but the key is
  // still valid.
  publicKeyBlock.processSignatures();
  assertEquals(0, publicKeyBlock.subKeys.length);

  // Tamper revocation signature
  var clone = getKey('RevokedSubKey');
  clone.subKeys[0].revocations_[0].signature.s ^= 0x01;
  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      clone.serialize());
  var error = assertThrows(function() {
      var key = e2e.openpgp.block.factory.parseAscii(tamperedAscii);
      key.processSignatures(); // Signature tampering invalidates the key.
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedMainKey() {
  var publicKeyBlock = getKey('RevokedMainKey');

  assertEquals(1, publicKeyBlock.keyPacket.revocations_.length);
  assertEquals(e2e.openpgp.packet.Signature.SignatureType.KEY_REVOCATION,
      publicKeyBlock.keyPacket.revocations_[0].signatureType);
  assertEquals(e2e.openpgp.packet.Signature.RevocationReason.KEY_COMPROMISED,
      publicKeyBlock.keyPacket.revocations_[0].attributes.REVOCATION_REASON);
  assertEquals('Main key revocation test',
      publicKeyBlock.keyPacket.revocations_[0].attributes.REVOCATION_REASON_TEXT);
  var error = assertThrows(function() {
      // The whole key is revoked, so this throws error
      publicKeyBlock.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);

  // Tamper revocation signature
  publicKeyBlock.keyPacket.revocations_[0].signature.s ^= 0x01;
  var tamperedAscii = e2e.openpgp.asciiArmor.encode('PUBLIC KEY BLOCK',
      publicKeyBlock.serialize());
  var error = assertThrows(function() {
      var key = e2e.openpgp.block.factory.parseAscii(tamperedAscii)
      key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
}


function testGnupgRevokedUid() {
  var key = getKey('RevokedUserId');
  var foreignKeyId = [106, 105, 167, 16, 15, 140, 92, 71];
  assertEquals(2, key.userIds.length);
  assertEquals(2, key.userIds[0].certifications_.length);
  assertEquals(2, key.userIds[1].certifications_.length);
  assertEquals(1, key.userIds[0].revocations_.length);
  assertEquals(0, key.userIds[1].revocations_.length);
  // Self-signatures
  assertArrayEquals(key.keyPacket.keyId,
      key.userIds[0].certifications_[0].getSignerKeyId());
  assertArrayEquals(key.keyPacket.keyId,
      key.userIds[1].certifications_[0].getSignerKeyId());
  // Revocation self-signature
  assertArrayEquals(key.keyPacket.keyId,
      key.userIds[0].revocations_[0].getSignerKeyId());
  // Foreign signatures
  assertArrayEquals(foreignKeyId,
      key.userIds[0].certifications_[1].getSignerKeyId());
  assertArrayEquals(foreignKeyId,
      key.userIds[1].certifications_[1].getSignerKeyId());
  // Apply signatures
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals(2, key.userIds[0].certifications_.length);
  assertArrayEquals(key.keyPacket.keyId,
      key.userIds[0].certifications_[0].getSignerKeyId());
  assertArrayEquals(foreignKeyId,
      key.userIds[0].certifications_[1].getSignerKeyId());
  assertEquals(0, key.userIds[0].revocations_.length);

  // Check that signature tampering is detected
  key = getKey('RevokedUserId');
  key.userIds[0].revocations_[0].signature.s ^= 0x01;
  assertThrows(function() {
    key.processSignatures();
  });

  // Check that signatures by unknown keys are ignored.
  key = getKey('RevokedUserId');
  key.userIds[0].revocations_[0].untrustedAttributes.ISSUER[0] ^= 0x01;
  key.processSignatures();
  assertEquals(2, key.userIds.length);
};

function testGnupgUserAttr() {
  var key = getKey('UserAttr');
  assertEquals(1, key.userIds.length);
  assertEquals(1, key.userAttributes.length);
  key.processSignatures();
  assertEquals(1, key.userIds.length);
  assertEquals(1, key.userAttributes.length);
  key.userAttributes[0].certifications_ = [];
  // Lack of certification removes User Attribute, but does not throw error.
  key.processSignatures();
  assertEquals(0, key.userAttributes.length);
  // Tampering would throw an error though
  key = getKey('UserAttr');
  key.userAttributes[0].data[0] ^= 0x01;
  var error = assertThrows(function() {
    key.processSignatures();
  });
  assertTrue(error instanceof e2e.openpgp.error.SignatureError);
};

function testKeyUsageFlags() {
  var key = getKey('GnuPgKeyUsageFlags');
  key.processSignatures();
  assertObjectEquals(key.subKeys[1], key.getKeyToEncrypt());
}

</script>
